#!/usr/bin/env node
const fs = require('fs');
const path = require('path');

// When run from web/ directory (after cd web), .next is in current directory
// When run from monorepo root, .next is in web/.next
const routesManifestPath = process.cwd().endsWith('/web') || process.cwd().endsWith('\\web')
  ? path.join(process.cwd(), '.next', 'routes-manifest.json')
  : path.join(process.cwd(), 'web', '.next', 'routes-manifest.json');
const routesManifestDir = path.dirname(routesManifestPath);

// Create .next directory if it doesn't exist
if (!fs.existsSync(routesManifestDir)) {
  fs.mkdirSync(routesManifestDir, { recursive: true });
}

// Create minimal routes-manifest.json for Next.js App Router
// This file is not generated by Next.js 15 App Router, but Vercel expects it
const routesManifest = {
  version: 3,
  pages404: false,
  basePath: '',
  redirects: [],
  headers: [],
  rewrites: [],
  dynamicRoutes: [],
};

fs.writeFileSync(routesManifestPath, JSON.stringify(routesManifest, null, 2));
console.log(`âœ… Created routes-manifest.json at ${routesManifestPath}`);
